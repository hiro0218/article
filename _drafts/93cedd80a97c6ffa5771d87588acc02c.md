---
ID: 3368
post_title: '[JavaScript] Promise形式のgetJson'
permalink: https://b.0218.jp/?p=3368
published: false
---
```language-js
function getJSON(url) {
  return new Promise(function(resolve, reject) {
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
      if (xhr.readyState == 4) {
        if (xhr.status == 200) {
          var response = xhr.response;
          if (typeof response === &#039;string&#039;) {
            response = JSON.parse(response);
          }
          resolve(response);
        } else {
          reject(xhr.statusText);
        }
      }
    };

    xhr.onerror = function() {
      reject(Error(&quot;network error&quot;));
    };

    xhr.open(&#039;GET&#039;, url, true);
    xhr.responseType = &#039;json&#039;;
    xhr.send();
  });
}

//////

getJSON(&#039;https://example.com/json-api/hoge&#039;)
    .then(function(json) {
        console.log(json);
    });
```