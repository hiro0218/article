---
ID: 3368
post_title: '[JavaScript] Promise形式のgetJson'
published: false
post_date: 2017-11-04 20:00:08
modified_date: 2017-11-04 20:00:08
slug: '[JavaScript] Promise形式のgetJson'
categories: |
  ---
  - !php/object "O:7:\"WP_Term\":16:{s:7:\"term_id\";i:1;s:4:\"name\";s:9:\"\u672A\u5206\u985E\";s:4:\"slug\";s:27:\"%e6%9c%aa%e5%88%86%e9%a1%9e\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:1;s:8:\"taxonomy\";s:8:\"category\";s:11:\"description\";s:0:\"\";s:6:\"parent\";i:0;s:5:\"count\";i:5;s:6:\"filter\";s:3:\"raw\";s:6:\"cat_ID\";i:1;s:14:\"category_count\";i:5;s:20:\"category_description\";s:0:\"\";s:8:\"cat_name\";s:9:\"\u672A\u5206\u985E\";s:17:\"category_nicename\";s:27:\"%e6%9c%aa%e5%88%86%e9%a1%9e\";s:15:\"category_parent\";i:0;}"
  ...
tags: |
  --- []
  ...
---
```language-js
function getJSON(url) {
  return new Promise(function(resolve, reject) {
    var xhr = new XMLHttpRequest();
    xhr.onreadystatechange = function() {
      if (xhr.readyState == 4) {
        if (xhr.status == 200) {
          var response = xhr.response;
          if (typeof response === &#039;string&#039;) {
            response = JSON.parse(response);
          }
          resolve(response);
        } else {
          reject(xhr.statusText);
        }
      }
    };

    xhr.onerror = function() {
      reject(Error(&quot;network error&quot;));
    };

    xhr.open(&#039;GET&#039;, url, true);
    xhr.responseType = &#039;json&#039;;
    xhr.send();
  });
}

//////

getJSON(&#039;https://example.com/json-api/hoge&#039;)
    .then(function(json) {
        console.log(json);
    });
```