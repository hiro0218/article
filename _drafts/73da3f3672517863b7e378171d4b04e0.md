---
ID: 3142
post_title: '[WordPress] 投稿時間の相対差(time ago)を出力する方法'
permalink: https://b.0218.jp/?p=3142
published: false
---
## 概要

`1 minutes ago`、`2 days ago`など相対的な時間差を出力する。

## コード

WordPressに標準関数があるが、痒いところに手が届かないため、もし細かい調整などが必要であれば自前で実装するほうが良い。

### WordPressの標準関数

`human_time_diff`を使用する。
`human_time_diff`への引数には、($from, $to)の形式で渡す。

```language-php
echo human_time_diff( get_the_time(&#039;U&#039;), current_time(&#039;timestamp&#039;) ) . &#039; ago&#039;;
```


### 自前で実装する

```language-php
function get_posted_time_ago($timestamp) {
    if ($timestamp === null) {
        return &#039;&#039;;
    }

    $current_time = time();
    $difference = ($current_time - $timestamp);
    $periods = [&#039;second&#039;, &#039;minute&#039;, &#039;hour&#039;, &#039;day&#039;, &#039;week&#039;, &#039;month&#039;, &#039;year&#039;, &#039;decade&#039;];
    $lengths = [60, 60, 24, 7, 4.35, 12, 10];

    for ($i = 0; isset($lengths[$i]) and $difference &gt;= $lengths[$i]; $i++) {
        $difference /= $lengths[$i];
    }

    $difference = round($difference);

    if ($difference != 1) {
        $periods[$i] = $periods[$i] . &#039;s&#039;;
    }

    if ($difference &lt;= 0) {
        return &quot;&quot;;
    }

    return $difference . &#039; &#039; . $periods[$i] . &#039; ago&#039;;
}
```

### 更新されているか否かをチェックする

```language-php
function is_modified_post() {
    return (get_the_time(&#039;Ymd&#039;) &lt; get_the_modified_time(&#039;Ymd&#039;));
}
```