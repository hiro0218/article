---
ID: 3484
post_title: '[Vuex] stateを全て破棄する方法'
published: true
post_date: 2018-01-10 18:03:32
modified_date: 2018-01-10 18:03:32
slug: 20180110180332.html
categories: |
  ---
  - !php/object "O:7:\"WP_Term\":16:{s:7:\"term_id\";i:518;s:4:\"name\";s:6:\"Vue.js\";s:4:\"slug\";s:6:\"vue-js\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:526;s:8:\"taxonomy\";s:8:\"category\";s:11:\"description\";s:0:\"\";s:6:\"parent\";i:0;s:5:\"count\";i:5;s:6:\"filter\";s:3:\"raw\";s:6:\"cat_ID\";i:518;s:14:\"category_count\";i:5;s:20:\"category_description\";s:0:\"\";s:8:\"cat_name\";s:6:\"Vue.js\";s:17:\"category_nicename\";s:6:\"vue-js\";s:15:\"category_parent\";i:0;}"
  ...
tags: |
  ---
  - !php/object "O:7:\"WP_Term\":10:{s:7:\"term_id\";i:519;s:4:\"name\";s:6:\"Vue.js\";s:4:\"slug\";s:6:\"vue-js\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:527;s:8:\"taxonomy\";s:8:\"post_tag\";s:11:\"description\";s:0:\"\";s:6:\"parent\";i:0;s:5:\"count\";i:9;s:6:\"filter\";s:3:\"raw\";}"
  - !php/object "O:7:\"WP_Term\":10:{s:7:\"term_id\";i:520;s:4:\"name\";s:4:\"Vuex\";s:4:\"slug\";s:4:\"vuex\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:528;s:8:\"taxonomy\";s:8:\"post_tag\";s:11:\"description\";s:0:\"\";s:6:\"parent\";i:0;s:5:\"count\";i:3;s:6:\"filter\";s:3:\"raw\";}"
  ...
---
ログアウト処理などでstateをすべて破棄したい。

Vuexに組み込みで`destoryState()`,`clearState()`的なAPIが生えているのを期待していたのだが、無いようなので泥臭く実装を行う。

<!--more-->

## 方法
以下のような実装を行う。

```language-js
const initialState = {
  token: &#039;&#039;,
  isAuthenticated: false
};

export const state = () =&gt; Object.assign({}, initialState);

export const mutations = {
  destroySession(state) {
    for (let key in state) {
      if (initialState.hasOwnProperty(key)) {
        state[key] = initialState[key];
      }
    }
  }
};
```

簡単にいえば、対象のstateをループで削除していく処理である。

1. `state`は`initialState`と別で定義
2. mutationsの`destroySession()`内で初期化
  1. `state`と`initialState`でkeyが一致しているものだけ`initialState `で初期化する