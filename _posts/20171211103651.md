---
ID: 3442
post_title: '[CSS] visibilityを使ったフェードインアニメーションを実装する方法'
published: true
post_date: 2017-12-11 10:36:51
modified_date: 2017-12-11 10:36:51
slug: 20171211103651.html
categories: |
  ---
  - !php/object "O:7:\"WP_Term\":16:{s:7:\"term_id\";i:385;s:4:\"name\";s:3:\"CSS\";s:4:\"slug\";s:3:\"css\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:403;s:8:\"taxonomy\";s:8:\"category\";s:11:\"description\";s:0:\"\";s:6:\"parent\";i:0;s:5:\"count\";i:22;s:6:\"filter\";s:3:\"raw\";s:6:\"cat_ID\";i:385;s:14:\"category_count\";i:22;s:20:\"category_description\";s:0:\"\";s:8:\"cat_name\";s:3:\"CSS\";s:17:\"category_nicename\";s:3:\"css\";s:15:\"category_parent\";i:0;}"
  ...
tags: |
  ---
  - !php/object "O:7:\"WP_Term\":10:{s:7:\"term_id\";i:70;s:4:\"name\";s:3:\"CSS\";s:4:\"slug\";s:3:\"css\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:71;s:8:\"taxonomy\";s:8:\"post_tag\";s:11:\"description\";s:0:\"\";s:6:\"parent\";i:0;s:5:\"count\";i:28;s:6:\"filter\";s:3:\"raw\";}"
  ...
---
## 概要
jQueryの`fadeIn()`で使用されるようなフェードインアニメーションは、`display: none`が要素に当たるため、領域の確保（高さ・横幅が担保）がされない。そのためアニメーション時にレイアウトのガタツキが起こる可能性がある。

`display: none`を要素に当てると「無い状態」になってしまう為、あくまで「見えない状態」にしたい場合は`visibility: hidden`を当てるのが良い。さらに言うと、`visibility: hidden`はクリックする事ができない。そしてクリックしたり、アニメーションさせたりするのであれば`opacity: 0`が必要になる。

<!--more-->

## 実装
下記のような実装をすることでフェードインアニメーションが可能となる。

```language-scss
#target {
  visibility: hidden;
  
  &amp;.visible {
    visibility: visible;
    animation-duration: .5s;
    animation-name: fade-in;
  }
}
```

```language-css
@keyframes fade-in {
  0% {
    visibility: hidden;
    opacity: 0;
  }

  50% {
    visibility: visible;
    opacity: .5;
  }

  100% {
    visibility: visible;
    opacity: 1;
  }
}
```

何らかの方法で`visibility: hidden`が当たっている`#target`に`.visible`クラスをセットすることでフェードインしながら表示が可能になる。
Intersection Observerを使った要素検出と併用しても良いかもしれない。

単純に`opacity`だけでアニメーションするのも可能だが、`hover`時に要素ないにマウスポインターが変わる要素があったりすると格好が悪いし、`visibility`だけではアニメーションできないため併用している。