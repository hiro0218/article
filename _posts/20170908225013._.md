---
ID: 3216
post_title: '[WordPress] 検索結果で検索文字をハイライトする方法'
author: hiro
post_excerpt: ""
layout: post
permalink: https://b.0218.jp/20170908225013.html
published: true
post_date: 2017-09-08 22:50:13
---
検索結果に表示された文字列をハイライト表示させる。

<!--more-->

## コード

```language-php
function highlight_search_results($content) {
    if (!is_admin() &amp;&amp; is_search() &amp;&amp; is_main_query()) {
        $keys = implode(&#039;|&#039;, explode(&#039; &#039;, get_search_query()));
        $content = preg_replace(&#039;/&#039;. $keys .&#039;/iu&#039;, &#039;&lt;mark&gt;$0&lt;/mark&gt;&#039;, $content);
    }

    return $content;
}

add_filter(&#039;the_title&#039;, &#039;highlight_search_results&#039;);
add_filter(&#039;the_excerpt&#039;, &#039;highlight_search_results&#039;);
```

`the_title`(記事タイトル)、`the_excerpt`(記事内容)、`the_excerpt`(記事抜粋)などにも`add_filter`でハイライトを付与する事が可能だが、記事抜粋など`$content`内に検索文字列がないとハイライトできない。