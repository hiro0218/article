---
ID: 3343
post_title: '[WordPress] WP-APIの不要な項目を削除する'
author: hiro
layout: post
permalink: https://b.0218.jp/20171014002220.html
published: true
post_date: 2017-10-14 00:22:20
modified_date: ""
slug: 20171014002220.html
---
## 概要

WP-APIの`wp-json/wp/v2/posts/%post_id%`を叩くと以下のようなJSONデータが返ってくる（一部抜粋）

```language-js
{
  &quot;id&quot;: 843,
  &quot;date&quot;: &quot;2017-10-05T19:47:33&quot;,
  &quot;date_gmt&quot;: &quot;2017-10-05T10:47:33&quot;,
  &quot;guid&quot;: {
    &quot;rendered&quot;: &quot;https://b.0218.jp/?p=3343&quot;
  },
  &quot;modified&quot;: &quot;2017-10-06T16:40:09&quot;,
  &quot;modified_gmt&quot;: &quot;2017-10-06T07:40:09&quot;,
  &quot;slug&quot;: &quot;wordpress-wp-api-hoge&quot;,
  &quot;status&quot;: &quot;publish&quot;,
  &quot;type&quot;: &quot;post&quot;,
  &quot;link&quot;: &quot;https://b.0218.jp/wordpress-wp-api-hoge.html&quot;,
  &quot;title&quot;: {
    &quot;rendered&quot;: &quot;hoge hoge&quot;
  },
  &quot;content&quot;: {
    &quot;rendered&quot;: &quot;hoge hoge&quot;
  },
  &quot;author&quot;: 2,
  &quot;featured_media&quot;: 157,
  &quot;comment_status&quot;: &quot;open&quot;,
  &quot;ping_status&quot;: &quot;open&quot;,
  &quot;sticky&quot;: false,
  &quot;template&quot;: &quot;&quot;,
  &quot;format&quot;: &quot;standard&quot;,
  &quot;meta&quot;: []
  ...
}
```

個人的に`author`や`featured_media`の項目は不要だったし、データサイズが少しでも減るのであれば嬉しいのでバックエンド側で握りつぶすことにした。

## 対応方法

フィルターフック(`rest_prepare_post`)を使用する。

```language-php
add_filter(&#039;rest_prepare_post&#039;, function($response, $post, $request) {
    unset($response-&gt;data[&#039;author&#039;]);
    unset($response-&gt;data[&#039;featured_media&#039;]);

    return $response;
}, 10, 3);
```

引数に`$response`というオブジェクトが渡される。削除したい項目が`$response-data`にあるので上記のように`unset()`して、returnしてやれば良い。