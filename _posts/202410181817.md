---
title: '[JavaScript] 文字列がパスではなくURLかどうか判定する方法'
date: 2024-10-18T09:17:12Z
updated:
tags:
  - JavaScript
---

## 背景

JavaScriptで文字列をURLか判定する方法がいくつかあるが、どれが一番適しているのかを考えてみる過程で書いてみた。

## 正規表現を利用する

特定のブラウザに依存しない方法として、正規表現がよく利用される。

```js
const URL_REGEX = /^(https?:\/\/)?([\w.-]+)\.([a-zA-Z]{2,})(\/[\w.-]*)*\/?$/;
const isURL = (str) => URL_REGEX.test(str);
```

## `URL.canParse(str)`を利用する

サポートブラウザを考えなければ、`URL.canParse(str)`を利用するのが一番簡単（[URL: canParse() 静的メソッド](https://developer.mozilla.org/ja/docs/Web/API/URL/canParse_static)）。

```js
const isURL = (str) => URL.canParse(str);

isURL('https://example.com'); // true
isURL('hoge'); // false
```

サポートブラウザは以下の通り。

| Chrome | Edge | Firefox | Safari |
| :----: | :--: | :-----: | :----: |
|  120   | 120  |   115   |  17.0  |

## `URL`コンストラクタを利用する

```js
const isURL = (str) => {
  try {
    // 文字列をURLとして解析を試みる
    new URL(str);
    return true;
  } catch (e) {
    try {
      // プロトコルを追加してURLの解析を再試行
      // `example.com`のような文字列もURLとして認識される
      new URL(`http://${str}`);
      return true;
    } catch (e) {
      return false;
    }
  }
};

isURL('https://example.com'); // true
isURL('hoge'); // false
```

サポートブラウザは以下の通り。

| Chrome | Edge | Firefox | Safari |
| :----: | :--: | :-----: | :----: |
|   19   |  12  |   26    |  14.1  |

## パフォーマンス

パフォーマンスを比較すると以下の順番になった。

1. 正規表現: 100%
2. `URL.canParse(str)`: 17%
3. `URL`コンストラクタ: 3%

[ベンチマークの結果 | Perflink](https://perf.link/#eyJpZCI6ImM5NHlzOG1uaGU4IiwidGl0bGUiOiJGaW5kaW5nIG51bWJlcnMgaW4gYW4gYXJyYXkgb2YgMTAwMCIsImJlZm9yZSI6ImNvbnN0IFVSTF9SRUdFWCA9IC9eKGh0dHBzPzpcXC9cXC8pPyhbXFx3Li1dKylcXC4oW2EtekEtWl17Mix9KShcXC9bXFx3Li1dKikqXFwvPyQvO1xuY29uc3QgaXNVUkwxID0gKHN0cikgPT4gVVJMX1JFR0VYLnRlc3Qoc3RyKTtcblxuY29uc3QgaXNVUkwyID0gKHN0cikgPT4gVVJMLmNhblBhcnNlKHN0cik7XG5cbmNvbnN0IGlzVVJMMyA9IChzdHIpID0%2BIHtcbiAgdHJ5IHtcbiAgICBuZXcgVVJMKHN0cik7XG4gICAgcmV0dXJuIHRydWU7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICB0cnkge1xuICAgICAgbmV3IFVSTChgaHR0cDovLyR7c3RyfWApO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxufTsiLCJ0ZXN0cyI6W3sibmFtZSI6IjEiLCJjb2RlIjoiaXNVUkwxKCdodHRwczovL2V4YW1wbGUuY29tJyk7XG5pc1VSTDEoJ2hvZ2UnKTsiLCJydW5zIjpbMTc3MDAwLDEwMDAsMTcxMDAwLDE0MTQwMDAsODUzMDAwLDQxMjcwMDAsMjU2MDAwLDQ5OTYwMDAsMzUzMzAwMCw0NTQ5MDAwLDQwNDQwMDAsNDk4MDAwMCwzNTYwMDAwLDM5NzkwMDAsNTQ1MTAwMCw0MTQyMDAwLDM2ODIwMDAsNzEyMTAwMCwzMzgyMDAwLDQwOTgwMDAsMzE3MDAwMCwyODEzMDAwLDg2MjAwMCw2NjY4MDAwLDUwMDUwMDAsNDQzMjAwMCw0MDI5MDAwLDkzMDAwMCw3NTA3MDAwLDMwMDkwMDAsNDUxNjAwMCw0OTI0MDAwLDEyMDEwMDAsMjg1ODAwMCwzNzMzMDAwLDE5OTYwMDAsNDY3NzAwMCwyMjc0MDAwLDEyOTAwMDAsNzQ3NTAwMCwyMzU3MDAwLDUyNDQwMDAsMzc2MzAwMCw3NjI3MDAwLDMwNTUwMDAsMzQxMDAwLDc1MjgwMDAsMzc3MDAwMCw1OTYyMDAwLDE4NjgwMDAsMjE1MTAwMCw0Mjk4MDAwLDUzNjIwMDAsNzY2NDAwMCwxMzE2MDAwLDIwMTYwMDAsMjI5NTAwMCwzNTE4MDAwLDE4NzAwMCw1Mzg0MDAwLDQ3NjQwMDAsNTM3NTAwMCw0MjYxMDAwLDUxNzIwMDAsMzg5MDAwLDc3NjQwMDAsMjY0NTAwMCw0ODQwMDAwLDMzMDQwMDAsOTk3NjAwMCwxODM3MDAwLDMzNDgwMDAsNDcxMDAwMCw1Mjk3MDAwLDQ0MjMwMDAsMzIxOTAwMCw1MjcwMDAwLDQwNDUwMDAsMzg1NzAwMCwyMjg1MDAwLDg0MzIwMDAsMzEyODAwMCw1Nzc0MDAwLDM5NjkwMDAsMjA2OTAwMCwyNTYwMDAsNzI1MDAwMCwzOTA0MDAwLDM2MDQwMDAsMzM2NjAwMCw4NzM4MDAwLDI3OTcwMDAsNDMwNTAwMCw1NDk2MDAwLDUxMDcwMDAsODcxMDAwMCwzMDYxMDAwLDQyNDEwMDAsNDAyMjAwMCwzODg0MDAwXSwib3BzIjozOTI0ODUwfSx7Im5hbWUiOiIyIiwiY29kZSI6ImlzVVJMMignaHR0cHM6Ly9leGFtcGxlLmNvbScpO1xuaXNVUkwyKCdob2dlJyk7IiwicnVucyI6WzEzMDAwMCwxMDAwLDEwMDAsMzc4MDAwLDUzMDAwLDcyOTAwMCwxNTUwMDAwLDkxNTAwMCw3NTYwMDAsODE3MDAwLDU0MjAwMCwxMjU0MDAwLDY5NjAwMCw2MTUwMDAsODM1MDAwLDc2MTAwMCw2MjMwMDAsMTEyMzAwMCw0MzYwMDAsNjc0MDAwLDcwMTAwMCw2MjMwMDAsMjMwMDAsOTMxMDAwLDgxNjAwMCw5NDIwMDAsNTAzMDAwLDI1NjAwMCwxMTgwMDAwLDQ5NjAwMCw3MTQwMDAsNzQ0MDAwLDI1NjAwMCw0NjYwMDAsNjY4MDAwLDI5NzAwMCw2ODkwMDAsNjI3MDAwLDI4NzAwMCwxMjU5MDAwLDQ0MzAwMCw3NTIwMDAsNjc5MDAwLDEzNzgwMDAsNTUyMDAwLDU5MDAwLDExMTEwMDAsNTI3MDAwLDgwODAwMCw0NzgwMDAsNDU3MDAwLDY5NjAwMCw4NTgwMDAsOTY4MDAwLDMyOTAwMCw0MzIwMDAsNDY2MDAwLDM1NjAwMCwxMDkwMDAsODIyMDAwLDc2NTAwMCw4MDMwMDAsODc1MDAwLDEwMzkwMDAsNzgwMDAsMTA5NzAwMCw2MDcwMDAsODY1MDAwLDQ0MjAwMCwxMzQxMDAwLDI1NjAwMCwzNTUwMDAsOTk2MDAwLDcwNzAwMCwxMzQyMDAwLDYzNzAwMCw4ODkwMDAsNjkzMDAwLDg0NTAwMCwyOTAwMDAsMTQzOTAwMCw1MjEwMDAsOTA3MDAwLDcyNTAwMCwyNzQwMDAsMTM5MDAwLDEyNjQwMDAsMzgxMDAwLDU0MTAwMCw1NzEwMDAsMTU2MzAwMCw1NTEwMDAsNzUzMDAwLDExMDgwMDAsODA3MDAwLDExNzcwMDAsNDU2MDAwLDc1MDAwMCw2NDYwMDAsNjQwMDAwXSwib3BzIjo2Nzc4MjB9LHsibmFtZSI6IjMiLCJjb2RlIjoiaXNVUkwzKCdodHRwczovL2V4YW1wbGUuY29tJyk7XG5pc1VSTDMoJ2hvZ2UnKTsiLCJydW5zIjpbMzE3MDAwLDI1MDAwLDM0MTAwMCwxMDAwLDM5MTAwMCw2MDAwMCwyNjIwMDAsMTI4MDAwLDYwMDAwLDEzOTAwMCwxMDIwMDAsMjgyMDAwLDEzNDAwMCw2NTAwMCwxNjUwMDAsMTA2MDAwLDk3MDAwLDIyMzAwMCwyMTAwMCw3MjAwMCw2MzAwMCwxMTEwMDAsMzk0MDAwLDEzNDAwMCwxMTAwMDAsMTI4MDAwLDY5MDAwLDQyMDAwMCwyMDAwMDAsMTYwMDAsMTA1MDAwLDE1NTAwMCw0NzAwMCw2MjAwMCw2MzAwMCwxNTAwMCw2MDAwMCw1MzAwMCw0NjgwMDAsMjIxMDAwLDE4MDAwLDE0MDAwMCw2NTAwMCwyMDcwMDAsNTcwMDAsNDEyMDAwLDI0ODAwMCw3MTAwMCwxNzAwMDAsMTkwMDAsMjUwMDAsNjgwMDAsMTI3MDAwLDE4NjAwMCwxMDAwLDYxMDAwLDI2MDAwLDg5MDAwLDkwMDAsMTA5MDAwLDk4MDAwLDEwMjAwMCwxNTgwMDAsMjA0MDAwLDQyMzAwMCwyMjQwMDAsMTAyMDAwLDEyOTAwMCw1NjAwMCwyNjIwMDAsMTAwMCw2MTAwMCwxMzgwMDAsMTQ3MDAwLDI5OTAwMCw2NzAwMCwxMTYwMDAsNjQwMDAsOTIwMDAsNDMwMDAsMjUxMDAwLDExNDAwMCwxOTgwMDAsNjkwMDAsNDIwMDAsNDI1MDAwLDIwMDAwMCwzNzAwMCw1NjAwMCwxNDAwMCwzMTgwMDAsNDMwMDAsMTMwMDAwLDEzMjAwMCwxMzgwMDAsMzExMDAwLDc2MDAwLDExODAwMCwxMDUwMDAsNjkwMDBdLCJvcHMiOjEzNjI1MH1dLCJ1cGRhdGVkIjoiMjAyNC0xMC0xOFQwOTo1MDozMC44NzNaIn0%3D)

単純なURLの検証であれば正規表現が最適。ただ、対象の文字列（URL）解析、操作が必要になってくうる場合はURLコンストラクタを利用せざるを得ないが、モダンブラウザ対象であれば`URL.canParse()`を利用するといった選択になっていきそう。
