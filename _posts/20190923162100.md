---
ID: 4326
post_title: '[WordPress] REST APIの投稿項目をフィルターする方法'
permalink: https://b.0218.jp/20190923162423.html
published: true
post_date: 2019-09-23 16:24:23
modified_date: ""
slug: 20190923162100.html
---
WP REST APIは、パラメータによってレスポンスを変えることができる。

以前は`filter[key]`みたいなパラメータでフィルタリング出来ていたが、現状使えない模様。


## 環境

確認した環境はこちら

- WordPress 5.2


## 実現方法

### 通常の取得方法

WP REST API で記事一覧を取得する時に以下のようなAPIを叩く。

```
https://demo.wp-api.org/wp-json/wp/v2/posts
```

そうすると下記のようなレスポンスが返却される。

```language-json
[
  {
    &quot;id&quot;: 1,
    &quot;date&quot;: &quot;2017-05-23T06:25:50&quot;,
    &quot;date_gmt&quot;: &quot;2017-05-23T06:25:50&quot;,
    &quot;guid&quot;: {
      &quot;rendered&quot;: &quot;http://demo.wp-api.org/?p=1&quot;
    },
    &quot;modified&quot;: &quot;2017-05-23T06:25:50&quot;,
    &quot;modified_gmt&quot;: &quot;2017-05-23T06:25:50&quot;,
    &quot;slug&quot;: &quot;hello-world&quot;,
    &quot;status&quot;: &quot;publish&quot;,
    &quot;type&quot;: &quot;post&quot;,
    &quot;link&quot;: &quot;https://demo.wp-api.org/2017/05/23/hello-world/&quot;,
    &quot;title&quot;: {
      &quot;rendered&quot;: &quot;Hello world!&quot;
    },
    &quot;content&quot;: {
      &quot;rendered&quot;: &quot;&lt;p&gt;Welcome to &lt;a href=\&quot;http://wp-api.org/\&quot;&gt;WP API Demo Sites&lt;/a&gt;. This is your first post. Edit or delete it, then start blogging!&lt;/p&gt;\n&quot;,
      &quot;protected&quot;: false
    },
    &quot;excerpt&quot;: {
      &quot;rendered&quot;: &quot;&lt;p&gt;Welcome to WP API Demo Sites. This is your first post. Edit or delete it, then start blogging!&lt;/p&gt;\n&quot;,
      &quot;protected&quot;: false
    },
    &quot;author&quot;: 1,
    &quot;featured_media&quot;: 0,
    &quot;comment_status&quot;: &quot;open&quot;,
    &quot;ping_status&quot;: &quot;open&quot;,
    &quot;sticky&quot;: false,
    &quot;template&quot;: &quot;&quot;,
    &quot;format&quot;: &quot;standard&quot;,
    &quot;meta&quot;: [],
    &quot;categories&quot;: [
      1
    ],
    &quot;tags&quot;: [],
    &quot;_links&quot;: {
      &quot;self&quot;: [
        {
          &quot;href&quot;: &quot;https://demo.wp-api.org/wp-json/wp/v2/posts/1&quot;
        }
      ],
      &quot;collection&quot;: [
        {
          &quot;href&quot;: &quot;https://demo.wp-api.org/wp-json/wp/v2/posts&quot;
        }
      ],
      &quot;about&quot;: [
        {
          &quot;href&quot;: &quot;https://demo.wp-api.org/wp-json/wp/v2/types/post&quot;
        }
      ],
      &quot;author&quot;: [
        {
          &quot;embeddable&quot;: true,
          &quot;href&quot;: &quot;https://demo.wp-api.org/wp-json/wp/v2/users/1&quot;
        }
      ],
      &quot;replies&quot;: [
        {
          &quot;embeddable&quot;: true,
          &quot;href&quot;: &quot;https://demo.wp-api.org/wp-json/wp/v2/comments?post=1&quot;
        }
      ],
      &quot;version-history&quot;: [
        {
          &quot;count&quot;: 0,
          &quot;href&quot;: &quot;https://demo.wp-api.org/wp-json/wp/v2/posts/1/revisions&quot;
        }
      ],
      &quot;wp:attachment&quot;: [
        {
          &quot;href&quot;: &quot;https://demo.wp-api.org/wp-json/wp/v2/media?parent=1&quot;
        }
      ],
      &quot;wp:term&quot;: [
        {
          &quot;taxonomy&quot;: &quot;category&quot;,
          &quot;embeddable&quot;: true,
          &quot;href&quot;: &quot;https://demo.wp-api.org/wp-json/wp/v2/categories?post=1&quot;
        },
        {
          &quot;taxonomy&quot;: &quot;post_tag&quot;,
          &quot;embeddable&quot;: true,
          &quot;href&quot;: &quot;https://demo.wp-api.org/wp-json/wp/v2/tags?post=1&quot;
        }
      ],
      &quot;curies&quot;: [
        {
          &quot;name&quot;: &quot;wp&quot;,
          &quot;href&quot;: &quot;https://api.w.org/{rel}&quot;,
          &quot;templated&quot;: true
        }
      ]
    }
  }
]
```

### フィルターの取得方法

`_fields`というパラメータを使うとフィルタリングが出来る。

```
_fields={表示したいキー}
```

これを踏まえた上で下記のパラメータでAPIを叩く。

```
https://demo.wp-api.org/wp-json/wp/v2/posts?_fields=id,slug
```

そうすると大量の情報がフィルタリングされて、id, slugだけになる。

```language-json
[
  {
    &quot;id&quot;: 1,
    &quot;slug&quot;: &quot;hello-world&quot;
  }
]
```

## おわり

クライアント側としては、`content`の内容など不要というケースは多いので、必要な情報だけ取得してレスポンスの大きさを減らしていきたい。