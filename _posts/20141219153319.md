---
ID: 1549
post_title: '[PHP] 配列の重複を消す方法'
published: true
post_date: 2014-12-19 15:33:19
modified_date: 2015-02-28 23:24:14
slug: 20141219153319.html
categories: |
  ---
  - !php/object "O:7:\"WP_Term\":16:{s:7:\"term_id\";i:386;s:4:\"name\";s:3:\"PHP\";s:4:\"slug\";s:3:\"php\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:404;s:8:\"taxonomy\";s:8:\"category\";s:11:\"description\";s:0:\"\";s:6:\"parent\";i:0;s:5:\"count\";i:23;s:6:\"filter\";s:3:\"raw\";s:6:\"cat_ID\";i:386;s:14:\"category_count\";i:23;s:20:\"category_description\";s:0:\"\";s:8:\"cat_name\";s:3:\"PHP\";s:17:\"category_nicename\";s:3:\"php\";s:15:\"category_parent\";i:0;}"
  ...
tags: |
  --- []
  ...
---
<code>array_unique()</code>を使うときに気を付けること
<!--more-->
<h2>前提条件</h2>
例えば、こんな配列がある。
<pre>Array
(
    [0] => 1
    [1] => 2
    [2] => 3
    [3] => 4
    [4] => 5
    [5] => 6
    [6] => 7
    [7] => 8
    [8] => 9
    [9] => 2
    [10] => 4
    [11] => 6
    [12] => 8
    [13] => 0
)</pre>
この配列は [9],[10],[11],[12] が重複している。
この重複した要素を削除したい。

複雑な配列であればループで取り出したりする手間があるが、今回の場合は単純な配列なので関数を使う。

<h2>解決方法</h2>
<h3>注意点</h3>
前述のように<code>array_unique()</code>を使うのだが、この関数の注意点は<strong>添え字が飛ぶ</strong>ことである。

先ほどの配列をこの<code>array_unique()</code>に渡すと以下のような結果が返ってくる
<pre>Array
(
    [0] => 1
    [1] => 2
    [2] => 3
    [3] => 4
    [4] => 5
    [5] => 6
    [6] => 7
    [7] => 8
    [8] => 9
    [13] => 0
)</pre>
重複箇所の要素が消え、添え字が飛んでることがわかる。

<h3>解決方法</h3>
添え字の飛んだ配列に<code>array_values()</code>を使う。

<code>array_values()</code>は、数値添字をつけた配列を返してくれるので、飛んだ添え字を埋めてくれるような動きになる。

<h3>コード</h3>
何かと使うことが多いので関数化した。

<pre class="prettyprint linenums lang-php">public static function get_unique($array){
    return array_values( array_unique($array) );
}</pre>

以下のような値が返ってくる
<pre>Array
(
    [0] => 1
    [1] => 2
    [2] => 3
    [3] => 4
    [4] => 5
    [5] => 6
    [6] => 7
    [7] => 8
    [8] => 9
    [9] => 0
)</pre>