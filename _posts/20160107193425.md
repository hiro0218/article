---
ID: 2354
post_title: '[Windows] PHPMDを導入してAtomで使用する方法'
published: true
post_date: 2016-01-07 19:34:25
modified_date: 2016-01-07 19:34:25
slug: 20160107193425.html
categories: |
  ---
  - !php/object "O:7:\"WP_Term\":16:{s:7:\"term_id\";i:343;s:4:\"name\";s:6:\"\u958B\u767A\";s:4:\"slug\";s:11:\"development\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:361;s:8:\"taxonomy\";s:8:\"category\";s:11:\"description\";s:0:\"\";s:6:\"parent\";i:0;s:5:\"count\";i:30;s:6:\"filter\";s:3:\"raw\";s:6:\"cat_ID\";i:343;s:14:\"category_count\";i:30;s:20:\"category_description\";s:0:\"\";s:8:\"cat_name\";s:6:\"\u958B\u767A\";s:17:\"category_nicename\";s:11:\"development\";s:15:\"category_parent\";i:0;}"
  ...
tags: |
  ---
  - Atom
  - Windows
  ...
---
Windows 上の PHP環境で PHPMD を利用してみる。
<!--more-->

<h2>環境</h2>
こんな人向け。
<ul>
	<li>Windows で開発</li>
	<li>PHPの実行はゲストOS上(Vagrantなど使用)で行っているが、コーディングはWindows上</li>
</ul>

<h2>PHPの環境を構築する</h2>
WindowsでPHPを簡単に構築するなら、<a href="https://www.apachefriends.org/jp/index.html" target="_blank" rel="noopener noreferrer">XAMPP</a>。
もしPHPの動作環境がWindows上にないなら入れておく。

Eclipseに同梱されているものでも良い。

XAMPPを導入した場合、以下にPHPの各モジュールが配置される。
```
C:\xampp\php
```

<h2>Composerを導入</h2>
公式サイトにWindowsのインストーラも用意されているが、自分の環境では上手く行かなかった。なので、インストーラは使わないで導入したいと思う。

<h3>OpenSSL</h3>
あらかじめOpenSSLを有効にしておく必要がある。（XAMPPは有効になっていた）
<code>php.ini</code>の以下のコメントアウトを外す。

```
;extension=php_openssl.dll
```


<h3>Composer</h3>
以下のコマンドで導入できる。

<pre class="cmd"><code>C:\xampp\php&gt;php -r "readfile('https://getcomposer.org/installer');" | php</code></pre>

<h2>PHPMDのインストール</h2>
<h3>composer.json</h3>
php のあるディレクトリ(自分の場合は c:\xampp\php)に以下の様な<code>composer.json</code>を配置する。
(PHPCSも一緒に入れたのでこんな風になっているが…)

```
{
    &quot;require&quot;: {
        &quot;squizlabs/php_codesniffer&quot;: &quot;*&quot;,
        &quot;phpmd/phpmd&quot;: &quot;*&quot;
    }
}
```


<h3>composer install</h3>
以下のコマンドを実行する。

```
C:\xampp\php&gt;php composer.phar install
```

完了するとPHPMDが導入されているはず。

<h3>確認</h3>
同じ手順を踏んでいれば以下にPHPMDが配置されている。
<pre class="cmd">C:\xampp\php\vendor\bin\phpmd</pre>

<h2>Atomで使用する</h2>
<h3>Linter</h3>
以下のLinterをインストールする。

```
apm install linter
apm install linter-phpmd
```

<h3>linter-phpmdの設定</h3>
<code>.atom/config.cson</code>に以下の記述をする。

```
&quot;linter-phpmd&quot;:
    executablePath: &quot;C:\\xampp\\php\\vendor\\bin\\phpmd&quot;
    rulesets: &quot;cleancode,codesize,controversial,design,unusedcode&quot;
```

<code>rulesets</code>はお好みで。

<h3>確認</h3>
適当なphpファイルを編集してみる。（保存など）
問題があった場合、指摘箇所に波線が表示され、指摘を修正すると表示が消える。