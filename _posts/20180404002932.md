---
ID: 3546
post_title: '[Nuxt.js] hard-source-webpack-plugin導入時のエラー対処法'
published: true
post_date: 2018-04-04 00:29:32
modified_date: 2018-04-04 00:29:32
slug: 20180404002932.html
categories: |
  ---
  - !php/object "O:7:\"WP_Term\":16:{s:7:\"term_id\";i:536;s:4:\"name\";s:7:\"Nuxt.js\";s:4:\"slug\";s:7:\"nuxt.js\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:544;s:8:\"taxonomy\";s:8:\"category\";s:11:\"description\";s:151:\"Vue.js
  \u30A2\u30D7\u30EA\u30B1\u30FC\u30B7\u30E7\u30F3\u306E\u30D5\u30EC\u30FC\u30E0\u30EF\u30FC\u30AF\u3067\u3042\u308B
  Nuxt.js \u306B\u3064\u3044\u3066\u3001\u30C8\u30E9\u30D6\u30EB\u30B7\u30E5\u30FC\u30C6\u30A3\u30F3\u30B0\u306A\u3069\u3092\u8A18\u8F09\u3057\u3066\u3044\u307E\u3059\";s:6:\"parent\";i:0;s:5:\"count\";i:5;s:6:\"filter\";s:3:\"raw\";s:6:\"cat_ID\";i:536;s:14:\"category_count\";i:5;s:20:\"category_description\";s:151:\"Vue.js
  \u30A2\u30D7\u30EA\u30B1\u30FC\u30B7\u30E7\u30F3\u306E\u30D5\u30EC\u30FC\u30E0\u30EF\u30FC\u30AF\u3067\u3042\u308B
  Nuxt.js \u306B\u3064\u3044\u3066\u3001\u30C8\u30E9\u30D6\u30EB\u30B7\u30E5\u30FC\u30C6\u30A3\u30F3\u30B0\u306A\u3069\u3092\u8A18\u8F09\u3057\u3066\u3044\u307E\u3059\";s:8:\"cat_name\";s:7:\"Nuxt.js\";s:17:\"category_nicename\";s:7:\"nuxt.js\";s:15:\"category_parent\";i:0;}"
  ...
tags: |
  ---
  - !php/object "O:7:\"WP_Term\":10:{s:7:\"term_id\";i:523;s:4:\"name\";s:7:\"Nuxt.js\";s:4:\"slug\";s:7:\"nuxt-js\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:531;s:8:\"taxonomy\";s:8:\"post_tag\";s:11:\"description\";s:0:\"\";s:6:\"parent\";i:0;s:5:\"count\";i:4;s:6:\"filter\";s:3:\"raw\";}"
  - !php/object "O:7:\"WP_Term\":10:{s:7:\"term_id\";i:519;s:4:\"name\";s:6:\"Vue.js\";s:4:\"slug\";s:6:\"vue-js\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:527;s:8:\"taxonomy\";s:8:\"post_tag\";s:11:\"description\";s:0:\"\";s:6:\"parent\";i:0;s:5:\"count\";i:9;s:6:\"filter\";s:3:\"raw\";}"
  ...
---
Nuxt.js で構築したプロジェクトに[HardSourceWebpackPlugin](https://github.com/mzgoddard/hard-source-webpack-plugin)を導入した。そこで上手くビルドが出来なくなってしまった。

## どんな問題が起きたか

`npm run dev`の初回は問題なし。

ただ、次回の`npm run dev`実行時に、下記のようなエラーが発生した。

```
  ████████████████████ 91% additional chunk assets processing/nuxt-project/node_modules/hard-source-webpack-plugin/node_modules/source-list-map/lib/fromStringWithSourceMap.js:11
	var sources = map.sources;
	                  ^
TypeError: Cannot read property &#039;sources&#039; of undefined
    at fromStringWithSourceMap (/nuxt-project/node_modules/hard-source-webpack-plugin/node_modules/source-list-map/lib/fromStringWithSourceMap.js:11:20)
```

`npm run build`なども同様。

## 解決方法
[Trouble Shooting の Hot Reloading](https://github.com/mzgoddard/hard-source-webpack-plugin#hot-reloading-is-not-working) に関する注記に関連した問題だった。

そもそも、Nuxt.jsがここで参照すべきファイルの実体は`/.nuxt/dist/.cache/hard-source/〜`になるので、`nuxt.config.js`への指定は下記のように指定する必要がある。

```language-js
new HardSourceWebpackPlugin({
  cacheDirectory: &#039;.cache/hard-source/[confighash]&#039;,
}),
```

デフォルト: `node_module/.cache/hard-source/〜`

## まとめ
時間の掛かっていたビルドが高速化されるようになった。（初回を除く）