---
ID: 3546
post_title: '[Nuxt.js] hard-source-webpack-plugin導入時のエラー対処法'
published: true
post_date: 2018-04-04 00:29:32
modified_date: 2018-04-04 00:29:32
slug: 20180404002932.html
---
<p>Nuxt.js で構築したプロジェクトに<a href="https://github.com/mzgoddard/hard-source-webpack-plugin">HardSourceWebpackPlugin</a>を導入した。そこで上手くビルドが出来なくなってしまった。</p>
<h2>どんな問題が起きたか</h2>
<p><code>npm run dev</code>の初回は問題なし。</p>
<p>ただ、次回の<code>npm run dev</code>実行時に、下記のようなエラーが発生した。</p>
<pre><code>  ████████████████████ 91% additional chunk assets processing/nuxt-project/node_modules/hard-source-webpack-plugin/node_modules/source-list-map/lib/fromStringWithSourceMap.js:11
    var sources = map.sources;
                      ^
TypeError: Cannot read property 'sources' of undefined
    at fromStringWithSourceMap (/nuxt-project/node_modules/hard-source-webpack-plugin/node_modules/source-list-map/lib/fromStringWithSourceMap.js:11:20)
</code></pre>
<p><code>npm run build</code>なども同様。</p>
<h2>解決方法</h2>
<p><a href="https://github.com/mzgoddard/hard-source-webpack-plugin#hot-reloading-is-not-working">Trouble Shooting の Hot Reloading</a> に関する注記に関連した問題だった。</p>
<p>そもそも、Nuxt.jsがここで参照すべきファイルの実体は<code>/.nuxt/dist/.cache/hard-source/〜</code>になるので、<code>nuxt.config.js</code>への指定は下記のように指定する必要がある。</p>
<pre><code class="language-js">new HardSourceWebpackPlugin({
  cacheDirectory: '.cache/hard-source/[confighash]',
}),
</code></pre>
<p>デフォルト: <code>node_module/.cache/hard-source/〜</code></p>
<h2>まとめ</h2>
<p>時間の掛かっていたビルドが高速化されるようになった。（初回を除く）</p>