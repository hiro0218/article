---
ID: 3216
post_title: '[WordPress] 検索結果で検索文字をハイライトする方法'
published: true
post_date: 2017-09-08 22:50:13
modified_date: 2017-09-08 22:50:13
slug: 20170908225013.html
categories: |
  ---
  - !php/object "O:7:\"WP_Term\":16:{s:7:\"term_id\";i:76;s:4:\"name\";s:9:\"WordPress\";s:4:\"slug\";s:9:\"wordpress\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:78;s:8:\"taxonomy\";s:8:\"category\";s:11:\"description\";s:0:\"\";s:6:\"parent\";i:0;s:5:\"count\";i:37;s:6:\"filter\";s:3:\"raw\";s:6:\"cat_ID\";i:76;s:14:\"category_count\";i:37;s:20:\"category_description\";s:0:\"\";s:8:\"cat_name\";s:9:\"WordPress\";s:17:\"category_nicename\";s:9:\"wordpress\";s:15:\"category_parent\";i:0;}"
  ...
tags: |
  ---
  - WordPress
  ...
---
検索結果に表示された文字列をハイライト表示させる。

<!--more-->

## コード

```language-php
function highlight_search_results($content) {
    if (!is_admin() &amp;&amp; is_search() &amp;&amp; is_main_query()) {
        $keys = implode(&#039;|&#039;, explode(&#039; &#039;, get_search_query()));
        $content = preg_replace(&#039;/&#039;. $keys .&#039;/iu&#039;, &#039;&lt;mark&gt;$0&lt;/mark&gt;&#039;, $content);
    }

    return $content;
}

add_filter(&#039;the_title&#039;, &#039;highlight_search_results&#039;);
add_filter(&#039;the_excerpt&#039;, &#039;highlight_search_results&#039;);
```

`the_title`(記事タイトル)、`the_excerpt`(記事内容)、`the_excerpt`(記事抜粋)などにも`add_filter`でハイライトを付与する事が可能だが、記事抜粋など`$content`内に検索文字列がないとハイライトできない。