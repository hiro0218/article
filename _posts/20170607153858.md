---
ID: 3084
title: '[Firefox] imgの縦横サイズが保たれない場合の対処法'
published: true
date: 2017-06-07 15:38:58
updated: 2017-06-07 15:38:58
slug: 20170607153858.html
categories:
  - CSS
tags:
  - Firefox
---
## 状況
画像の遅延読み込みの為、`src`に直接URLを指定せずにdata属性に指定して、JavaScriptで置き換える処理を行っていた。

```language-html
<img data-src="https://example.jp/super.png">
```

このimg要素には`height / width`が指定されているが、Firefoxにおいては縦横サイズが保たれずに、JSによるsrc置き換え後の画像ロード後に縦横サイズが決まるような動きであった。
Chrome や Safari では問題なし。

## 対処法
### そもそもの原因
Firefoxだと、img要素にsrcが無い場合に「壊れた画像」として扱われ、縦横サイズを指定してもサイズが保たれないようである。（`alt`の内容だけを表示される）

### コード
`src`にダミー画像をセットしておけば解決するが、下記のようなCSSを指定する事でも解決する。
```language-css
img {
  -moz-force-broken-image-icon: 1;
}
```

## 参考
[-moz-force-broken-image-icon - CSS | MDN](https://developer.mozilla.org/ja/docs/Web/CSS/-moz-force-broken-image-icon)