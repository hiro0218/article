---
ID: 3005
post_title: >
  文字化けしないように文字コードの違うページへフォームをPOST/GETする方法
permalink: https://b.0218.jp/20170407124324.html
published: true
post_date: 2017-04-07 12:43:24
modified_date: ""
slug: 20170407124324.html
---
`UTF-8`から`Shift_JIS`のページへPOSTする場合の方法。（GETでも同じ方法でOK）

POST先の文字コードは、以下で`SHIT_JIS`となっている箇所を変えれば対応できる。
<!--more-->

## 方法
### IE以外（Chrome / Firefox）
```language-markup
&lt;form name=&quot;form1&quot; method=&quot;POST&quot; accept-charset=&quot;Shift_JIS&quot;&gt;
```

`accept-charset`を指定する。

### IE用
IEは `accept-charset` が効かないので、以下のようなJSが必要になる。

```language-javascript
document.forms.form1.addEventListener(&#039;submit&#039;, set_sjis_charset);

function set_sjis_charset(e) {
  var ua = window.navigator.userAgent.toLowerCase();
  var isIE = (ua.indexOf(&quot;msie&quot;) &gt; -1 || ua.indexOf(&quot;trident/7.0&quot;) &gt; -1 || ua.indexOf(&quot;edge&quot;) &gt; -1);
  if (isIE) {
    e.preventDefault();
    this.removeEventListener(&#039;submit&#039;, set_sjis_charset);
    var tmp = document.charset;
    document.charset = &#039;Shift_JIS&#039;;
    this.submit();
    document.charset = tmp;
  }
}
```

キャラセットを変更するのはIEだけで良いのでIEチェックをしている。