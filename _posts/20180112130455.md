---
ID: 3492
post_title: '[GTM] aタグのリクエストが二重送信される問題の対処法'
published: true
post_date: 2018-01-12 13:04:55
modified_date: 2018-01-17 14:30:30
slug: 20180112130455.html
categories: |
  ---
  - !php/object "O:7:\"WP_Term\":16:{s:7:\"term_id\";i:14;s:4:\"name\";s:15:\"\u30D7\u30ED\u30B0\u30E9\u30E0\";s:4:\"slug\";s:7:\"program\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:14;s:8:\"taxonomy\";s:8:\"category\";s:11:\"description\";s:0:\"\";s:6:\"parent\";i:0;s:5:\"count\";i:121;s:6:\"filter\";s:3:\"raw\";s:6:\"cat_ID\";i:14;s:14:\"category_count\";i:121;s:20:\"category_description\";s:0:\"\";s:8:\"cat_name\";s:15:\"\u30D7\u30ED\u30B0\u30E9\u30E0\";s:17:\"category_nicename\";s:7:\"program\";s:15:\"category_parent\";i:0;}"
  ...
tags: |
  ---
  - !php/object "O:7:\"WP_Term\":10:{s:7:\"term_id\";i:530;s:4:\"name\";s:18:\"Google
  Tag Manager\";s:4:\"slug\";s:18:\"google-tag-manager\";s:10:\"term_group\";i:0;s:16:\"term_taxonomy_id\";i:538;s:8:\"taxonomy\";s:8:\"post_tag\";s:11:\"description\";s:0:\"\";s:6:\"parent\";i:0;s:5:\"count\";i:1;s:6:\"filter\";s:3:\"raw\";}"
  ...
---
## 現象
google tag managerを導入した環境で、`<a>`タグのリンクが二重送信されてしまう。

<!--more-->

## 原因
フォーラムでも指摘のある通り、gtm.jsのバグである事は間違いなさそう。

追ってみると、`google_tag_manager.autoEventSettings.clc: 2000`という条件によって発生している事が分かった。
この設定を消す方法だが、フォーラムには暫定的な回避方法があり、<mark>「リンクトリガー設定の『タグの配信を待つ』という設定(デフォルトが2000ミリ秒)」</mark>の設定をオフにすれば良かった。この設定オフにする事で二重送信は回避できるようになった。


## 参考

- [Google グループ - Bug report | _triggers variable suddely blocking firing](https://productforums.google.com/forum/#!topic/tag-manager/ws4tDK5bpq0;context-place=forum/tag-manager)
- [Google グループ - a Tag with Javascript firing twice](https://productforums.google.com/forum/#!topic/tag-manager/QVb2sNyvp5k;context-place=forum/tag-manager)

## 追記

解決した模様。

> **Quick update from the Google Tag Manager team:** This issue should now be resolved. Please let us know if you experience any further issues. Thank you, and apologies for any inconvenience.

https://productforums.google.com/d/msg/tag-manager/QVb2sNyvp5k/5F4Danh3AwAJ