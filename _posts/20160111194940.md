---
ID: 2360
post_title: '[WordPress] 一括で全ての投稿記事のパーマリンクを取得する方法'
permalink: https://b.0218.jp/20160111194940.html
published: true
post_date: 2016-01-11 19:49:40
modified_date: ""
slug: 20160111194940.html
---
この記事で言えば https://b.0218.jp/20160111194940.html のようなURLで取得する。

<!--more-->

## 使用シーン
Google Analytics などと付き合わせを行う際に記事のURLが必要である場合… など。

## 取得方法
### XML ファイルをエクスポート

`get_permalink()`で取得できるが、*管理画面*から一発で取得したい。

`ツール > エクスポート`から「*エクスポートファイルをダウンロード*」でXMLをダウンロードする。

### 処理
以下のようなXMLが出力される。

```language-xml
&lt;item&gt;
    &lt;title&gt;[Windows] PHPMDを導入してAtomで使用する方法&lt;/title&gt;
    &lt;link&gt;https://b.0218.jp/20160107193425.html&lt;/link&gt;
    &lt;pubDate&gt;Thu, 07 Jan 2016 10:34:25 +0000&lt;/pubDate&gt;
    &lt;dc:creator&gt;&lt;![CDATA[hiro]]&gt;&lt;/dc:creator&gt;
    &lt;guid isPermaLink=&quot;false&quot;&gt;https://b.0218.jp/?p=2354&lt;/guid&gt;
    &lt;description&gt;&lt;/description&gt;
    &lt;content:encoded&gt;&lt;![CDATA[]]&gt;&lt;/content:encoded&gt;
    &lt;excerpt:encoded&gt;&lt;![CDATA[]]&gt;&lt;/excerpt:encoded&gt;
    &lt;wp:post_id&gt;2354&lt;/wp:post_id&gt;
    &lt;wp:post_date&gt;&lt;![CDATA[2016-01-07 19:34:25]]&gt;&lt;/wp:post_date&gt;
    &lt;wp:post_date_gmt&gt;&lt;![CDATA[2016-01-07 10:34:25]]&gt;&lt;/wp:post_date_gmt&gt;
&lt;/item&gt;
```

`<item>`内に投稿の情報がある。その子要素に`<link>`という項目がある。このタグ内に期待のURLが含まれている。

#### 正規表現を使う

`<link>`タグ内にURLが記載されているので、その行のみを取得する。

`<link>`が含まれない行を選択する正規表現は以下。

```
^(?!.*&lt;link&gt;).+$
```

これに合致しない行を全て削除すればURLが含まれた行のみを抽出できる。