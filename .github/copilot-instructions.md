# 執筆スタイルガイドライン

## AI Agent向けガイドライン

### 著者のペルソナ

記事の著者には以下のような特徴が見られます：

- 技術的背景: ウェブ開発（特にフロントエンド）、TypeScript、Git、HTML/CSS等に精通している
- 思考特性: 論理的・分析的思考が強く、問題解決指向で体系的に情報を整理する
- 対象読者: 中級〜上級エンジニアを主な対象とし、実践的な知識を重視
- 執筆スタイル: 客観的で正確な情報提供を心がけ、読者の疑問を先回りして回答
- 記事の構造:「概念説明→問題提起→解決策→実装例→考察」の流れを意識した構成

## 🔴 必須遵守事項

1. フロントマターは変更禁止（日時・タグ構造の保持）
2. 画像パスは`/images/`で開始
3. ファイル名は`YYYYMMDDHHmm.md`形式を厳守
4. 「である調」で統一
5. 一文150文字以内
6. textlint修正は1ファイル単位で実行

## プロジェクト構造

このリポジトリは日本語の技術記事をMarkdownで管理する専用プロジェクトである。記事は主に以下の構造で管理される：

- `_posts/` - 公開済み記事（YYYYMMDDHHmm.md形式）
- `_drafts/` - 下書き記事（数値IDまたは日時形式の混在）
- `images/` - 記事で使用する画像ファイル

## 記事作成ワークフロー

### 新規記事作成

```bash
npm run new                    # 現在日時で記事作成
npm run new -- -d "2024-01-01 12:34"  # 指定日時で記事作成
```

`cli.js`がAsia/Tokyoタイムゾーンで日時を処理し、`YYYYMMDDHHmm.md`形式のファイル名とUTC形式のフロントマターを自動生成。

### 記事品質チェック

```bash
npm run lint:text     # 日本語文法・スタイルチェック
npm run format        # Prettierでフォーマット
npm run link:check    # リンク切れチェック
```

## 記事執筆スタイル

### フロントマター（🔴 必須）

```yaml
---
title: '[分野/技術] 内容の説明'
date: YYYY-MM-DDThh:mm:ss.sssZ
updated:
tags:
  - タグ1
  - タグ2
---
```

`date`はUTC形式、`title`は「[分野/技術］説明」パターンを使用。違反時はコミット拒否。

### 文体と構成

- 「である調」で統一（textlintで自動チェック、`preferInBody: "である"`設定済み）
- 一文150文字以内
- 見出しは`## (h2)`から開始
- コードブロックには言語指定必須
- 技術的詳細は具体例を3つ以上含める

## 文章・文体ガイドライン

### 編集の基本方針

#### 優先順位

1. **簡潔性** - 無駄な文章の徹底的な削除
2. **実用性** - 自分が使うための背景情報は保持
3. **正確性** - 技術的事実の徹底検証
4. **読みやすさ** - 自然で分かりやすい表現

#### 編集プロセス

1. **内容の簡潔化** - 冗長表現・AI的表現の削除
2. **構成の最適化** - 見出し・章立ての改善
3. **事実確認** - 外部資料によるファクトチェック
4. **表現の調整** - 文章表現・textlint対応

#### 文体

- **である調**で統一（技術文書として読みやすく、権威性を保つ）
- 硬すぎず、自然で読みやすい表現を重視
- 専門用語を適切に使い、初心者にも理解しやすい説明

#### 文章構成

- **問題解決型**の構成を基本とする
  1. 課題・背景の明確化
  2. 解決方法の提示
  3. 具体的な実装例
  4. 注意点・制約事項
  5. まとめ

### 見出し設計

#### 原則

- **シンプルで直感的**な見出しを使用
- 抽象的な表現を避け、内容が一目で分かるものにする
- 疑問文よりも断定的な表現を好む

#### 推奨パターン

- `課題` / `背景` / `問題`
- `解決方法` / `方法` / `手順`
- `実装例` / `使用例` / `サンプル`
- `注意点` / `制約事項` / `留意点`
- `まとめ`

#### 避けるべき表現

- 「なぜ〜するのか」（冗長）
- 「〜の方法について」（回りくどい）
- 「〜と〜」（内容が混在して不明確）
  - 例：「設定と使い方」→「設定」と「使い方」を別見出しに分離
  - 例：「インストールと初期化」→個別の手順として記載

### AI表現の排除

#### 削除対象の表現

- **AI特有の硬い表現**
  - 「〜について説明する」「〜を紹介する」
  - 「〜と言える」「〜できる」（冗長な形）
  - 「〜に関して」「〜に対して」

#### 自然な表現への変換

- 説明→直接表現：「方法を説明する」→「方法」
- 冗長表現の簡略化：「利用できる」→「利用できる」
- 回りくどい表現の短縮：「〜することが重要である」→「〜が重要だ」

### 技術的正確性の確保

#### 事実確認の徹底

- 一次資料の参照：RFC・公式ドキュメント・仕様書
- 複数ソースでの検証：技術情報の裏取り
- 最新情報の確認：廃止・非推奨情報の注記

#### 参考文献の必須化

- 技術仕様に関する主張は必ず出典を明記
- RFC番号・公式ドキュメントのリンクを提供
- セキュリティ関連情報は特に慎重に検証

#### セキュリティ注意事項

- リスクの具体的説明（ログ記録・履歴残存など）
- 適用場面の明確な限定
- 本番環境での使用禁止の明記

### 文章表現

#### 基本ルール

- **一文150文字以内**を目標とする
- 助詞の重複を避ける（textlint対応）
- 読点を適切に使い、読みやすさを確保

#### 好む表現

- `〜である` / `〜だ`（断定的）
- `〜できる`（可能性を示す）
- `〜必要がある`（必要性を示す）
- `〜が望ましい`（推奨を示す）

#### 避ける表現

- `〜と思われる`（曖昧）
- `〜という感じ`（口語的）
- `非常に` / `とても`（感情的）
- AI生成文章特有の硬い表現

### コード表現

#### コードブロック

- 必ず**言語指定**する
- コメントで説明を適切に追加
- 比較パターンは「従来の方法」→「改善後」の順で表示

#### 技術用語

- 初出時は**説明を併記**する（例：「userinfo（URI仕様で定義された形式）」）
- RFC番号などの技術仕様は正確に記載
- 英語の専門用語はカタカナ表記を併用

### 内容設計と記事の特徴

#### 記事の特徴

- **問題解決・トラブルシューティング中心**（全記事の80%以上）
- **実践的で即座に使える**内容を重視
- 背景説明は簡潔に、実装に重点を置く
- 実際に試せるサンプルコードを3個以上含める
- 客観的で正確な情報提供

#### 重要概念の説明構成

1. 定義（1-2文）
2. 目的（なぜ必要か）
3. 実装方法（コード例付き）
4. メリット・デメリット（各3点以上）

#### 情報の扱い

- **技術的正確性**を最優先
- セキュリティや制約事項は必ず明記
- 参考文献・根拠となる仕様書を明示

#### 読者への配慮

- 開発者の実務に即した内容
- コピー&ペーストで使えるサンプルコード
- 注意点は具体的なリスクとして説明

### 品質基準

#### textlint準拠

- 日本語技術文書向けプリセットに従う
- 助詞の重複、文字数制限を遵守
- 専門用語の表記統一

#### 構成要件

- フロントマターの正確な記述
- 参考文献の明記
- 画像パスの正確な指定（`/images/`）

#### 読みやすさ

- 短い段落で構成
- 箇条書きの効果的な活用
- 技術的詳細と概要のバランス

### 実際の編集実例

<!-- textlint-disable -->

#### 見出しの改善例

- 修正前：「なぜURLに認証情報を埋め込むのか」
- 修正後：「課題」

- 修正前：「使用上の注意と推奨場面」
- 修正後：「注意点」+「適用場面」

#### 文章の簡潔化例

- 修正前：「〜について説明する」
- 修正後：直接的な表現に変更

- 修正前：「利用することができる」
- 修正後：「利用できる」

#### AI表現の削除例

- 修正前：「〜と言える」
- 修正後：「〜である」

- 修正前：「〜に関して説明する」
- 修正後：直接説明に移行

#### 技術的補足の追加例

- RFC番号と非推奨情報の明記
- セキュリティリスクの具体化
- 参考文献リストの追加
<!-- textlint-enable -->

## 開発者向けツール設定

### textlint設定

#### 修正時の必須ルール（🔴 絶対遵守）

textlint --fixコマンドは1ファイル単位で実行すること。

```bash
# ✅ 正しい使用方法（1ファイルずつ指定）
npm run lint:text -- --fix _posts/202507142152.md
textlint --fix _posts/specific-file.md

# ❌ 絶対禁止（複数ファイル同時修正）
npm run lint:text -- --fix _posts/    # ディレクトリ全体の修正は禁止
textlint --fix _posts/*.md           # ワイルドカード使用は禁止
textlint --fix .                     # カレントディレクトリ全体は禁止
```

理由: 意図しない大量変更の防止、各ファイル固有の記述意図の保護、変更内容のレビュー容易化、問題発生時の影響範囲限定。

#### 適用ルール

- 日本語技術文書向けプリセット
  - `preset-ja-technical-writing`: 技術文書の文法チェック
  - `preset-jtf-style`: JTFスタイルガイド準拠
- AI記事向けルール
  - `@textlint-ja/preset-ai-writing`: AI特有の冗長表現を検出・修正

#### 許可語彙（`.textlintrc`で定義済み）

- IT用語: Web、アプリ、ポリフィル、コンポーネント、フレームワーク
- 固有名詞: GitHub、TypeScript、JavaScript、React、Vue

#### エラー時の対処法

```bash
# textlintエラーが出た場合（1ファイルずつ対処）
npm run lint:text _posts/target-file.md         # 1. 特定ファイルのエラー確認
npm run lint:text -- --fix _posts/target-file.md # 2. そのファイルのみ自動修正

# 複数ファイルにエラーがある場合の正しい対処法
for file in _posts/*.md; do
  echo "Checking: $file"
  npm run lint:text -- "$file"                   # 各ファイル個別にチェック
  read -p "Fix this file? (y/n) " -n 1 -r
  echo
  if [[ $REPLY =~ ^[Yy]$ ]]; then
    npm run lint:text -- --fix "$file"          # 確認後、1ファイルずつ修正
  fi
done
# 特定箇所を無視する場合のみ（最小限に留める）
<!-- textlint-disable -->
無視したい内容
<!-- textlint-enable -->
```

### 自動化

#### コミット時のhusky + nano-staged

1. Prettierで自動フォーマット（失敗時はコミット中止）
2. textlintで文法チェック（エラー時はコミット拒否）
3. Markdown-link-checkでリンク検証（404エラー時は警告）

#### エラー対処コマンド

```bash
# コミットが失敗した場合の対処手順
npm run lint:text          # 1. エラー内容を確認
npm run format            # 2. 自動修正を実行
git add .                 # 3. 修正内容をステージング
git commit -m "message"   # 4. 再度コミット
```

## エラー発生時の対処法

### よくあるエラーと解決方法

| エラー種別  | エラーメッセージ例             | 対処法                                                             |
| ----------- | ------------------------------ | ------------------------------------------------------------------ |
| textlint    | `である調でなければなりません` | `npm run lint:text -- --fix 対象ファイル.md`で該当ファイルのみ修正 |
| textlint    | `1文が長すぎます（151文字）`   | 文を2つに分割                                                      |
| prettier    | `Formatting error`             | `npm run format`を再実行                                           |
| link-check  | `404 Not Found`                | リンク先URLを確認・修正                                            |
| frontmatter | `Invalid date format`          | UTC形式に修正（例: 2024-01-01T12:00:00.000Z）                      |

### 緊急時の対処

```bash
# すべてのチェックをスキップしてコミット（非推奨・緊急時のみ）
git commit -m "message" --no-verify
# ただし、後で必ず修正すること
```

## ファイル命名規則

### 公開記事（`_posts/`）

- 形式: `YYYYMMDDHHmm.md`
- 例: `202507142152.md`（2025年7月14日21時52分）
- `npm run new`コマンドで自動生成（手動作成禁止）

### 下書き記事（`_drafts/`）

- 新規: 公開記事と同じ形式を使用
- 既存: 数値ID形式（`218.md`）は変更不要

### 違反時の修正手順

```bash
# ファイル名が規則違反の場合
mv 違反ファイル名.md $(date +"%Y%m%d%H%M").md  # 現在時刻で修正
```

## 品質監視と継続改善（実装状態: 推奨）

### 月次レビュープロセス

1. textlintルール違反の統計収集

   ```bash
   # エラー統計の自動収集
   git log --grep="textlint" --since="1 month ago" | wc -l
   # よくある修正パターンの抽出
   git diff --stat --since="1 month ago" -- _posts/*.md | sort -rn | head -10
   ```

2. よくあるエラーパターンの分析
   - 最も頻繁に発生するtextlintエラーの特定
   - 新しい専門用語の追加必要性の検討
   - ルールの厳しさの再評価

3. `.textlintrc`の許可語彙更新

   ```bash
   # 未登録の専門用語を検出
   npm run lint:text 2>&1 | grep "Unknown word" | sort | uniq
   ```

4. ガイドライン改訂の検討
   - 月末にチームでレビュー
   - 必要に応じてルールの追加・修正

### 改善追跡

#### 品質メトリクス

```bash
# コミット成功率の追跡
git log --since="1 month ago" --format="%h %s" | grep -v "\-\-no-verify" | wc -l

# textlint修正の自動化率
git log --since="1 month ago" --grep="textlint --fix" | wc -l
```

## リアルタイム品質監視（実装状態: 部分実装済）

### pre-commitフック（実装済み）

husky + nano-stagedでコミット前に自動検証。Prettierでフォーマット、textlintで文法チェック、Markdown-link-checkでリンク検証を実行。

### CI/CD統合（未実装・推奨）

GitHub Actions設定例 (`.github/workflows/quality-check.yml`):

```yaml
name: Quality Check
on:
  pull_request:
    paths:
      - '_posts/**/*.md'
      - '_drafts/**/*.md'

jobs:
  textlint:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - uses: actions/setup-node@v3
      - run: npm ci
      - run: npm run lint:text
      - run: npm run link:check
```

## AI Agentの実行権限（🔴 明確な境界）

### 自動実行可能（人間確認不要）

- textlint --fix（1ファイル単位のみ）
- npm run format（Prettierフォーマット）
- ファイル内容の編集（フロントマター以外）
- エラーログの取得・分析
- 統計情報の収集

### 人間確認必須

- 複数ファイルの一括変更（ディレクトリ単位の操作）
- フロントマターの変更（date、title、tagsの編集）
- ファイル名の変更
- `.textlintrc`の編集
- Gitコミット・プッシュ
- npmパッケージの追加・削除

### 実行例

```bash
# ✅ AI Agentが自動実行可能
npm run lint:text -- --fix _posts/202501011234.md  # 1ファイルのみ

# ❌ AI Agentには人間確認が必要
npm run lint:text -- --fix _posts/              # ディレクトリ全体
rm _posts/old-article.md                        # ファイル削除
git commit -m "Update articles"                 # コミット
```
